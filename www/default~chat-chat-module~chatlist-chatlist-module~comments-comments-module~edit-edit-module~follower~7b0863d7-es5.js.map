{"version":3,"sources":["webpack:///src/app/user.service.ts"],"names":["UserService","eventSubject","db","storage","storageRef","ref","allPosts","username","image","status","fullname","posts","followers","following","users","followingPostId","followingPosts","privateStat","homePosts","savedPosts","chats","saved","self","collection","onSnapshot","querySnapshot","forEach","doc","user","data","push","uid","length","id","publishEvent","foo","post","caption","comments","likes","posted","userimg","pid","next","userDoc","userRef","currUser","currentUser","get","then","setTimeout","includes","sort","a","b","temp","num","item","chat","uids","usernames","name","otherUid","postImg","postCap","Date","now","add","docRef","update","FieldValue","arrayUnion","url","privateStatus","imagePath","substr","indexOf","replace","substring","child","userFollowing","arrayRemove","usr","console","log","comment","exists","set","message","providedIn"],"mappings":"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","file":"default~chat-chat-module~chatlist-chatlist-module~comments-comments-module~edit-edit-module~follower~7b0863d7-es5.js","sourcesContent":["import { Injectable, SkipSelf } from '@angular/core';\nimport * as firebase from 'firebase';\nimport { Subject } from 'rxjs';\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UserService {\n  private eventSubject = new Subject<any>();\n  db = firebase.firestore();\n  storage = firebase.storage();\n  storageRef = this.storage.ref();\n  allPosts = [];\n  public username = \"\";\n  public image = \"\";\n  public status = \"\";\n  public fullname = \"\";\n  public posts = [];\n  public followers = [];\n  public following = [];\n  public users = [];\n  public followingPostId = [];\n  public followingPosts = [];\n  public privateStat = true;\n  public homePosts = [];\n  public savedPosts = [];\n  public chats = [];\n  public userDoc;\n  private userRef;\n  public currUser;\n  public saved = [];\n\n  publishEvent(data:any) {\n    this.eventSubject.next(data);\n  }\n  getObservable(): Subject<any> {\n    return this.eventSubject;\n  }\n  \n  constructor() {\n    var self = this;\n    this.db.collection(\"users\").onSnapshot(function(querySnapshot) {\n      self.users = [];\n      querySnapshot.forEach(function(doc) {\n        var user = doc.data();\n        self.users.push({username:user.username,image:user.image,uid:user.uid,\n          privateStat:user.privateStat,status:user.status,fullname:user.fullname,\n          followers:user.followers.length,following:user.following.length,id:doc.id,posts:user.posts.length});\n      })\n      self.publishEvent({foo:'bar'});\n    })\n\n    this.db.collection(\"posts\").onSnapshot(function(querySnapshot) {\n      self.allPosts = [];\n      querySnapshot.forEach(function(doc) {\n        var post = doc.data();\n        self.allPosts.push({caption:post.caption,comments:post.comments,\n          id:post.id,image:post.image,likes:post.likes,posted:post.posted,\n          userimg:post.userimg,username:post.username,pid:doc.id});\n      })\n      self.publishEvent({foo:'bar'});\n    })\n  }\n\n  setUsername(username,image,status,posts,followers,following,fullname,privateStat,userDoc,saved) {\n    var self = this;\n    this.username = username;\n    this.image = image;\n    this.status = status;\n    this.followers = followers;\n    this.following = following;\n    this.fullname = fullname;\n    this.privateStat = privateStat;\n    this.userDoc = userDoc;\n    this.posts = posts;\n    this.userRef = this.db.collection(\"users\").doc(this.userDoc);\n    this.followingPosts = [];\n    this.homePosts = [];\n    this.currUser = firebase.auth().currentUser.uid;\n\n    this.db.collection(\"posts\").onSnapshot(function(querySnapshot) {\n      self.allPosts = [];\n      self.followingPostId = [];\n      querySnapshot.forEach(function(doc) {\n        var post = doc.data();\n        self.allPosts.push({caption:post.caption,comments:post.comments,\n          id:post.id,image:post.image,likes:post.likes,posted:post.posted,\n          userimg:post.userimg,username:post.username,pid:doc.id});\n      })\n      self.publishEvent({foo:'bar'});\n    })\n\n    for(let user of following) {\n      var ref = self.db.collection(\"users\").doc(user.id);\n      ref.get().then(function(doc) {\n        var posts = doc.data().posts;\n        for(let post of posts) {\n          self.followingPostId.push(post);\n        }\n      })\n    }\n\n    setTimeout(() => {\n      for(let post of self.allPosts) {\n        if(posts.includes(post.pid)) {\n          self.homePosts.push(post);\n        } else if(self.followingPostId.includes(post.pid)) {\n          self.followingPosts.push(post);\n        }\n      }\n    }, 500);\n    \n    setTimeout(() => {\n      self.homePosts.sort((a,b) => (a.posted < b.posted) ? 1: -1);\n      self.followingPosts.sort((a,b) => (a.posted < b.posted) ? 1: -1);\n    }, 500);\n\n    this.db.collection(\"users\")\n    .onSnapshot(function(querySnapshot) {\n      querySnapshot.forEach(function(doc) {\n        var user = doc.data();\n        if(user.uid == self.currUser) {\n          self.username = user.username;\n          self.image = user.image;\n          self.status = user.status;\n          self.posts = user.posts;\n          self.following = user.following;\n          self.followers = user.followers;\n          self.fullname = user.fullname;\n          self.privateStat = user.privateStat;\n          self.saved = user.saved;\n          self.savedPosts = [];\n          setTimeout(() => {\n            for(let post of self.allPosts) {\n              if(self.saved.includes(post.pid)) {\n                self.savedPosts.push(post);\n              }\n            }\n            self.savedPosts.sort((a,b) => (a.posted < b.posted) ? 1: -1);\n          }, 500);\n        }\n      })\n      self.publishEvent({foo:'bar'});\n    })\n    \n    this.db.collection(\"users\").onSnapshot(function(querySnapshot) {\n      self.users = [];\n      querySnapshot.forEach(function(doc) {\n        var user = doc.data();\n        if(user.uid != self.currUser) {\n          var temp = user.followers;\n          var num = 0;\n          for(let item of temp) {\n            if(item.status == \"true\") {\n              num++;\n            }\n          }\n        self.users.push({username:user.username,image:user.image,uid:user.uid,\n          privateStat:user.privateStat,status:user.status,fullname:user.fullname,\n          followers:num,following:user.following.length,id:doc.id,posts:user.posts.length});\n        }\n      })\n      self.publishEvent({foo:'bar'});\n    })\n\n    this.db.collection(\"chat\").onSnapshot(function(querySnapshot) {\n      self.chats = [];\n      querySnapshot.forEach(function(doc) {\n        var chat = doc.data();\n        var uids = chat.uid;\n        if(uids.includes(self.currUser)) {\n          for(let name of chat.usernames) {\n            if(name != self.username) {\n              var username = name;\n            }\n          }\n          for(let uid of uids) {\n            if(uid != self.currUser) {\n              var otherUid = uid;\n            }\n          }\n          self.chats.push({username:username,id:chat.id,uid:otherUid});\n        }\n      })\n      self.publishEvent({foo:'bar'});\n    })\n\n  }\n\n  makePost(postImg, postCap) {\n    var self = this;\n    var likes = [];\n    likes.push(self.userDoc)\n    var comments = [];\n\n    this.homePosts.push({\n      'username': self.username,\n      'userimg': self.image,\n      'id': self.userDoc,\n      'posted': Date.now(),\n      'image': postImg,\n      'caption': postCap,\n      'likes': likes,\n      'comments': comments\n    })\n\n    this.db.collection(\"posts\").add({\n      'username': self.username,\n      'userimg': self.image,\n      'id': self.userDoc,\n      'posted': Date.now(),\n      'image': postImg,\n      'caption': postCap,\n      'likes': likes,\n      'comments': comments\n    }).then(function(docRef){\n      self.userRef.update({\n        posts: firebase.firestore.FieldValue.arrayUnion(docRef.id)\n      })\n    })\n  }\n\n  updateImage(url) {\n    this.image = url;\n    this.userRef.update({\n      image:url\n    })\n  }\n\n  updateProfile(fullname, username, status, privateStatus) {\n    this.fullname = fullname;\n    this.username = username;\n    this.status = status;\n    this.privateStat = privateStatus;\n    this.userRef.update({\n      'fullname':fullname,\n      'username':username,\n      'status':status,\n      'privateStat':privateStatus\n    })\n  }\n\n  removeProfilePic() {\n    if(this.image != \"assets/avatar.png\") {\n    let imagePath = this.image;\n    let name = imagePath.substr(imagePath.indexOf('%2F') + 3, (imagePath.indexOf('?')) - (imagePath.indexOf('%2F') + 3));\n    name = name.replace('%20',' ');\n    name = name.substr(name.indexOf('/o/'));\n    name = name.substring(3);\n    this.storageRef.child(name).delete();\n    this.userRef.update({\n      image:\"assets/avatar.png\"\n    })\n\n    this.image = \"assets/avatar.png\"\n  }\n  }\n\n  follow(user) {\n    var ref = this.db.collection(\"users\").doc(user.id);\n    ref.update({\n      followers: firebase.firestore.FieldValue.arrayUnion({username:this.username,uid:this.currUser,\n      status:\"req\",image:this.image,id:this.userDoc})\n    })\n  }\n\n  reqAccept(user) {\n    this.userFollowing(user);\n    this.userRef.update({\n      followers: firebase.firestore.FieldValue.arrayRemove({username: user.username,uid: user.uid,\n        status:user.status,image:user.image,id:user.id})\n    })\n\n    this.userRef.update({\n      followers: firebase.firestore.FieldValue.arrayUnion({username: user.username,uid: user.uid,\n        status:\"true\",image:user.image,id:user.id})\n    })\n  }\n\n  userFollowing(usr) {\n    var ref = this.db.collection(\"users\").doc(usr.id);\n    ref.update({\n      following: firebase.firestore.FieldValue.arrayUnion({username: this.username,uid:this.currUser,\n        status:\"true\",image:this.image,id:this.userDoc})\n    })\n  }\n\n  reqReject(user) {\n    this.userRef.update({\n      followers: firebase.firestore.FieldValue.arrayRemove({username: user.username,uid: user.uid,\n        status:user.status,image:user.image,id:user.id})\n    })\n  }\n\n  unfollow(user) {\n    var self = this;\n    console.log(user)\n    var userRef = this.db.collection(\"users\").doc(user.id);\n    userRef.update({\n      followers: firebase.firestore.FieldValue.arrayRemove({username:self.username,uid:self.currUser,\n        status:\"true\",image:this.image,id:self.userDoc})\n    })\n\n    this.userRef.update({\n      following: firebase.firestore.FieldValue.arrayRemove({username:user.username,uid: user.uid,\n      status:\"true\",image:user.image,id:user.id})\n    })\n  }\n\n  like(post) {\n    var self = this;\n    var id = post.pid;\n    var ref = this.db.collection(\"posts\").doc(id);\n    ref.update({\n      likes: firebase.firestore.FieldValue.arrayUnion(self.userDoc)\n    })\n  }\n\n  unlike(post) {\n    var self = this;\n    var id = post.pid;\n    var ref = this.db.collection(\"posts\").doc(id);\n    ref.update({\n      likes: firebase.firestore.FieldValue.arrayRemove(self.userDoc)\n    })\n  }\n\n  addComment(post,comment) {\n    var self = this;\n    var id = post.pid;\n    var ref = this.db.collection(\"posts\").doc(id);\n    ref.update({\n      comments: firebase.firestore.FieldValue.arrayUnion({\n        userimg: self.image,\n        username: self.username,\n        comment: comment\n      })\n    })\n  }\n\n  bookmark(post) {\n    var id = post.pid;\n    this.userRef.update({\n      saved: firebase.firestore.FieldValue.arrayUnion(id)\n    })\n  }\n\n  unsave(post) {\n    var id = post.pid;\n    this.userRef.update({\n      saved: firebase.firestore.FieldValue.arrayRemove(id)\n    })\n  }\n\n  createChat(user) {\n    var self = this;\n    var uid = user[0].uid;\n    var id = \"\";\n    if(uid < this.currUser) {\n      id = uid + this.currUser;\n    } else {\n      id = this.currUser + uid;\n    }\n\n    this.db.collection(\"chat\").doc(id).get()\n    .then(doc => {\n      if(!doc.exists) {\n        var uids = [self.currUser,uid];\n        var name = user[0].username;\n        var usernames = [self.username,name];\n        var chat = [];\n        self.db.collection(\"chat\").doc(id).set ({\n          'usernames':usernames,\n          'uid': uids,\n          'chat':chat,\n          'id':id\n        })\n      }\n    })\n  }\n\n  send(message,id) {\n    var self = this;\n    var ref = this.db.collection(\"chat\").doc(id)\n    ref.update({\n      chat: firebase.firestore.FieldValue.arrayUnion({\n      'time': Date.now(),\n      'name': self.username,\n      'message': message\n      })\n    })\n  }\n\n}"]}